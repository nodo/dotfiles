# needed for GitHub codespaces
export SHELL=/bin/zsh

# Homebrew (works on macOS and Linux)
if [[ -f /opt/homebrew/bin/brew ]]; then
  eval "$(/opt/homebrew/bin/brew shellenv)"
elif [[ -f /usr/local/bin/brew ]]; then
  eval "$(/usr/local/bin/brew shellenv)"
elif [[ -f /home/linuxbrew/.linuxbrew/bin/brew ]]; then
  eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
fi


# ----- History -----
HISTFILE="$HOME/.zsh_history"
HISTSIZE=50000
SAVEHIST=50000
setopt APPEND_HISTORY           # don't overwrite history
setopt INC_APPEND_HISTORY       # write history as commands are entered
setopt SHARE_HISTORY            # share across sessions
setopt HIST_IGNORE_DUPS         # ignore consecutive duplicates
setopt HIST_IGNORE_SPACE        # ignore commands starting with a space
setopt HIST_REDUCE_BLANKS       # remove superfluous blanks
setopt EXTENDED_HISTORY         # add timestamps

# ----- Safer shell behavior -----
setopt NO_BEEP
setopt INTERACTIVE_COMMENTS
setopt AUTO_CD                  # `foo` becomes `cd foo` when foo is a dir
setopt AUTO_PUSHD               # pushd on cd (enables `dirs -v`)
setopt PUSHD_IGNORE_DUPS
setopt PUSHD_SILENT
setopt COMPLETE_IN_WORD         # complete from middle of word

# ----- Completion system -----
autoload -Uz compinit && compinit -C

# Completion colors (uses LS_COLORS)
zstyle ':completion:*' list-colors "${(s.:.)LS_COLORS}"
zstyle ':completion:*' menu select
zstyle ':completion:*' matcher-list 'm:{a-z}={A-Z}'  # case-insensitive matching
zstyle ':completion:*:descriptions' format '%F{yellow}-- %d --%f'
zstyle ':completion:*:warnings' format '%F{red}-- no matches --%f'

# ----- Key bindings (sane defaults) -----
bindkey -e

# ----- PATH management -----
typeset -U path PATH
path=(
  "$HOME/.local/bin"
  "$HOME/bin"
  $path
)

# ----- Env vars -----
export CLICOLOR=1
# LS_COLORS: di=directories, ln=symlinks, so=sockets, pi=pipes, ex=executables
#            bd=block devices, cd=char devices, su=setuid, sg=setgid
#            tw=sticky+world-writable, ow=world-writable
# Colors: 30=black, 31=red, 32=green, 33=yellow, 34=blue, 35=magenta, 36=cyan
#         Background: 40-47 (same order)
export LS_COLORS='di=34:ln=35:so=32:pi=33:ex=31:bd=34;46:cd=34;43:su=30;41:sg=30;46:tw=30;42:ow=30;43'
export EDITOR='nvim'
export GIT_OPEN='nvim'
export GITHUB_USER=nodo
export RIPGREP_CONFIG_PATH="$HOME/.ripgreprc"
export ANTHROPIC_BASE_URL="https://api.githubcopilot.com"

# ----- Aliases -----
alias ll='ls -lah'
alias la='ls -A'
alias ..='cd ..'
alias ...='cd ../..'

eval "$(starship init zsh)"
